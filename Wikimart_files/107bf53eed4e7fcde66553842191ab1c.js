;// rotator.js



(function($){$.widget('ui.rotator',{_init:function(){this.$element=$(this.element);this.idPrefix='banner-'+Math.round(Math.random()*10000)+'-';this.loadedBannersCount=0;this.activeBannerIndex=0;this.mouseOver=false;this.defaultDisplayTime=5000;this.displayTimeLeft=this.defaultDisplayTime;this.interval=1000;this.rotationInProcess=false;this.mouseOverTimeout=null;this.rotationTimeout=null;this._render();this.$element.hover($.proxy(this._bannerMouseoverHandler,this),$.proxy(this._bannerMouseoutHandler,this));},_render:function(){var $banners=this.$banners=$('<ul class="banners" />');var $switchers=this.$switchers=$('<ul class="switchers" />').css('visibility','hidden');for(var i=0,count=this.options.banners.length;i<count;i++){var bannerId=this.idPrefix+i;var $img=$('<img alt="" />').load($.proxy(this._bannerLoadCompleteHandler,this)).attr('src',this.options.banners[i].imageUrl);var $link=$('<a />').attr('href',this.options.banners[i].targetUrl);if(this.options.banners.target!='_self'){$link.attr('target',this.options.banners[i].target);}
var $banner=$('<li id="'+bannerId+'" />');$link.append($img);$banner.append($link);var label=this.options.banners[i]?this.options.banners[i].label:i+1;var $switcherLink=$('<a href="#"><span><span><span>'+label+'</span></span></span></a>');$switcherLink.on('mouseenter click',i,$.proxy(this._switcherClickHandler,this));var $switcher=$('<li></li>');if(i>0){$banner.css('opacity',0).hide();}else{$switcher.addClass('active');}
$switcher.append($switcherLink);$banners.append($banner);$switchers.append($switcher);}
this.$element.append($banners);this.$element.append($switchers);},_bannerLoadCompleteHandler:function(){this.loadedBannersCount++;if(this.loadedBannersCount==this.options.banners.length){this.$switchers.css('visibility','visible');this._startRotation();}},_startRotation:function(){window.setInterval($.proxy(this._rotationIntervalCallback,this),this.interval);},_rotationIntervalCallback:function(){if(this.mouseOver==false){this.displayTimeLeft=this.displayTimeLeft-this.interval;if(this.displayTimeLeft<=0){this._rotate(this._getNextBannerIndex(this.activeBannerIndex));}}},_switcherClickHandler:function(e){var instance=this;if(this.loadedBannersCount==this.options.banners.length){window.clearTimeout(this.mouseOverTimeout);this.mouseOverTimeout=window.setTimeout(function(){instance._rotate(e.data);},100);}
e.preventDefault();},_bannerMouseoutHandler:function(){this.mouseOver=false;},_bannerMouseoverHandler:function(){this.mouseOver=true;},_rotate:function(bannerToActivateIndex){if(isNaN(bannerToActivateIndex))return;var instance=this;if(this.rotationInProcess){window.clearTimeout(this.rotationTimeout);this.rotationTimeout=window.setTimeout(function(){instance._rotate(bannerToActivateIndex);},100);}
if(this.activeBannerIndex==bannerToActivateIndex||this.rotationInProcess)return;this.rotationInProcess=true;var $banners=this.$banners.children();var $activeBanner=$banners.eq(this.activeBannerIndex);var $bannerToActivate=$banners.eq(bannerToActivateIndex);$activeBanner.animate({'opacity':0},1000);$bannerToActivate.css({'position':'absolute','top':'0'}).show().animate({'opacity':1},1000,function(){$activeBanner.hide();$bannerToActivate.css('position','static');instance.rotationInProcess=false;});this.activeBannerIndex=bannerToActivateIndex;this.displayTimeLeft=this.options.banners[this.activeBannerIndex].displayTime||this.defaultDisplayTime;var $switchers=this.$switchers.children();$switchers.removeClass('active');$switchers.eq(this.activeBannerIndex).addClass('active');},_getNextBannerIndex:function(activeBannerIndex){return(activeBannerIndex==this.options.banners.length-1)?0:activeBannerIndex+1;}});})(jQuery);

;// homepage/homepage.js



$(document).ready(function(){$(".scrollable").scrollable({touch:false});function resizeSlider(){var clientWidth=document.documentElement.clientWidth,contentWidth=document.getElementById('content').clientWidth-22,$arrows=$('.daily-deals-block .prev, .daily-deals-block .next'),$slide=$('.daily-deals-block .slide');if(clientWidth<=1170){$arrows.hide();$slide.width(contentWidth);if(clientWidth<=978){$slide.width('978');}}else{$arrows.show();$slide.width('1102');}
$(".scrollable").scrollable();}
resizeSlider();$(window).bind('resize',resizeSlider);});

;// jquery.tools/jquery.tools.scrollable.js



(function(a){a.tools=a.tools||{version:"v1.2.7"},a.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};function b(a,b){var c=parseInt(a.css(b),10);if(c)return c;var d=a[0].currentStyle;return d&&d.width&&parseInt(d.width,10)}function c(b,c){var d=a(c);return d.length<2?d:b.parent().find(c)}var d;function e(b,e){var f=this,g=b.add(f),h=b.children(),i=0,j=e.vertical;d||(d=f),h.length>1&&(h=a(e.items,b)),e.size>1&&(e.circular=!1),a.extend(f,{getConf:function(){return e},getIndex:function(){return i},getSize:function(){return f.getItems().size()},getNaviButtons:function(){return n.add(o)},getRoot:function(){return b},getItemWrap:function(){return h},getItems:function(){return h.find(e.item).not("."+e.clonedClass)},move:function(a,b){return f.seekTo(i+a,b)},next:function(a){return f.move(e.size,a)},prev:function(a){return f.move(-e.size,a)},begin:function(a){return f.seekTo(0,a)},end:function(a){return f.seekTo(f.getSize()-1,a)},focus:function(){d=f;return f},addItem:function(b){b=a(b),e.circular?(h.children().last().before(b),h.children().first().replaceWith(b.clone().addClass(e.clonedClass))):(h.append(b),o.removeClass("disabled")),g.trigger("onAddItem",[b]);return f},seekTo:function(b,c,k){b.jquery||(b*=1);if(e.circular&&b===0&&i==-1&&c!==0)return f;if(!e.circular&&b<0||b>f.getSize()||b<-1)return f;var l=b;b.jquery?b=f.getItems().index(b):l=f.getItems().eq(b);var m=a.Event("onBeforeSeek");if(!k){g.trigger(m,[b,c]);if(m.isDefaultPrevented()||!l.length)return f}var n=j?{top:-l.position().top}:{left:-l.position().left};i=b,d=f,c===undefined&&(c=e.speed),h.animate(n,c,e.easing,k||function(){g.trigger("onSeek",[b])});return f}}),a.each(["onBeforeSeek","onSeek","onAddItem"],function(b,c){a.isFunction(e[c])&&a(f).on(c,e[c]),f[c]=function(b){b&&a(f).on(c,b);return f}});if(e.circular){var k=f.getItems().slice(-1).clone().prependTo(h),l=f.getItems().eq(1).clone().appendTo(h);k.add(l).addClass(e.clonedClass),f.onBeforeSeek(function(a,b,c){if(!a.isDefaultPrevented()){if(b==-1){f.seekTo(k,c,function(){f.end(0)});return a.preventDefault()}b==f.getSize()&&f.seekTo(l,c,function(){f.begin(0)})}});var m=b.parents().add(b).filter(function(){if(a(this).css("display")==="none")return!0});m.length?(m.show(),f.seekTo(0,0,function(){}),m.hide()):f.seekTo(0,0,function(){})}var n=c(b,e.prev).click(function(a){a.stopPropagation(),f.prev()}),o=c(b,e.next).click(function(a){a.stopPropagation(),f.next()});e.circular||(f.onBeforeSeek(function(a,b){setTimeout(function(){a.isDefaultPrevented()||(n.toggleClass(e.disabledClass,b<=0),o.toggleClass(e.disabledClass,b>=f.getSize()-1))},1)}),e.initialIndex||n.addClass(e.disabledClass)),f.getSize()<2&&n.add(o).addClass(e.disabledClass),e.mousewheel&&a.fn.mousewheel&&b.mousewheel(function(a,b){if(e.mousewheel){f.move(b<0?1:-1,e.wheelSpeed||50);return!1}});if(e.touch){var p={};h[0].ontouchstart=function(a){var b=a.touches[0];p.x=b.clientX,p.y=b.clientY},h[0].ontouchmove=function(a){if(a.touches.length==1&&!h.is(":animated")){var b=a.touches[0],c=p.x-b.clientX,d=p.y-b.clientY;f[j&&d>0||!j&&c>0?"next":"prev"](),a.preventDefault()}}}e.keyboard&&a(document).on("keydown.scrollable",function(b){if(!(!e.keyboard||b.altKey||b.ctrlKey||b.metaKey||a(b.target).is(":input"))){if(e.keyboard!="static"&&d!=f)return;var c=b.keyCode;if(j&&(c==38||c==40)){f.move(c==38?-1:1);return b.preventDefault()}if(!j&&(c==37||c==39)){f.move(c==37?-1:1);return b.preventDefault()}}}),e.initialIndex&&f.seekTo(e.initialIndex,0,function(){})}a.fn.scrollable=function(b){var c=this.data("scrollable");if(c)return c;b=a.extend({},a.tools.scrollable.conf,b),this.each(function(){c=new e(a(this),b),a(this).data("scrollable",c)});return b.api?c:this}})(jQuery);

;// jquery.tmpl.min.js



(function(a){var r=a.fn.domManip,d="_tmplitem",q=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,b={},f={},e,p={key:0,data:{}},h=0,c=0,l=[];function g(e,d,g,i){var c={data:i||(d?d.data:{}),_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};e&&a.extend(c,e,{nodes:[],parent:d});if(g){c.tmpl=g;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++h;(l.length?f:b)[h]=c}return c}a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,d){a.fn[f]=function(n){var g=[],i=a(n),k,h,m,l,j=this.length===1&&this[0].parentNode;e=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&i.length===1){i[d](this[0]);g=this}else{for(h=0,m=i.length;h<m;h++){c=h;k=(h>0?this.clone(true):this).get();a.fn[d].apply(a(i[h]),k);g=g.concat(k)}c=0;g=this.pushStack(g,f,i.selector)}l=e;e=null;a.tmpl.complete(l);return g}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,l,j){if(d[0]&&d[0].nodeType){var f=a.makeArray(arguments),g=d.length,i=0,h;while(i<g&&!(h=a.data(d[i++],"tmplItem")));if(g>1)f[0]=[a.makeArray(d)];if(h&&c)f[2]=function(b){a.tmpl.afterManip(this,b,j)};r.apply(this,f)}else r.apply(this,arguments);c=0;!e&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(d,h,e,c){var j,k=!c;if(k){c=p;d=a.template[d]||a.template(null,d);f={}}else if(!d){d=c.tmpl;b[c.key]=c;c.nodes=[];c.wrapped&&n(c,c.wrapped);return a(i(c,null,c.tmpl(a,c)))}if(!d)return[];if(typeof h==="function")h=h.call(c||{});e&&e.wrapped&&n(e,e.wrapped);j=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)];return k?a(i(c,null,j)):j},tmplItem:function(b){var c;if(b instanceof a)b=b[0];while(b&&b.nodeType===1&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b==="string")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,"tmpl")||a.data(b,"tmpl",o(b.innerHTML));return typeof c==="string"?(a.template[c]=b):b}return c?typeof c!=="string"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function i(e,g,f){var b,c=f?a.map(f,function(a){return typeof a==="string"?e.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+e.key+'" $2'):a:i(a,e,a._ctnt)}):e;if(g)return c;c=c.join("");c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=j(c).concat(b);if(d)b=b.concat(j(d))});return b?b:j(c)}function j(c){var b=document.createElement("div");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(m,l,j,d,b,c,e){var i=a.tmpl.tag[j],h,f,g;if(!i)throw"Template command not found: "+j;h=i._default||[];if(c&&!/\w$/.test(b)){b+=c;c=""}if(b){b=k(b);e=e?","+k(e)+")":c?")":"";f=c?b.indexOf(".")>-1?b+c:"("+b+").call($item"+e:b;g=c?f:"(typeof("+b+")==='function'?("+b+").call($item):("+b+"))"}else g=f=h.$1||"null";d=k(d);return"');"+i[l?"close":"open"].split("$notnull_1").join(b?"typeof("+b+")!=='undefined' && ("+b+")!=null":"true").split("$1a").join(g).split("$1").join(f).split("$2").join(d?d.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(d,c,b,a){a=a?","+a+")":b?")":"";return a?"("+c+").call($item"+a:d}):h.$2||"")+"_.push('"})+"');}return _;")}function n(c,b){c._wrap=i(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join("")}function k(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(b){var a=document.createElement("div");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){var n="_"+c,k,j,l={},e,p,i;for(e=0,p=o.length;e<p;e++){if((k=o[e]).nodeType!==1)continue;j=k.getElementsByTagName("*");for(i=j.length-1;i>=0;i--)m(j[i]);m(k)}function m(j){var p,i=j,k,e,m;if(m=j.getAttribute(d)){while(i.parentNode&&(i=i.parentNode).nodeType===1&&!(p=i.getAttribute(d)));if(p!==m){i=i.parentNode?i.nodeType===11?0:i.getAttribute(d)||0:0;if(!(e=b[m])){e=f[m];e=g(e,b[i]||f[i],null,true);e.key=++h;b[h]=e}c&&o(m)}j.removeAttribute(d)}else if(c&&(e=a.data(j,"tmplItem"))){o(e.key);b[e.key]=e;i=a.data(j.parentNode,"tmplItem");i=i?i.key:0}if(e){k=e;while(k&&k.key!=i){k.nodes.push(j);k=k.parent}delete e._ctnt;delete e._wrap;a.data(j,"tmplItem",e)}function o(a){a=a+n;e=l[a]=l[a]||g(e,b[e.parent.key+n]||e.parent,null,true)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(""):b).filter(d||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery)

;// catalog/geofilter.js



(function($){$.widget('ui.wmGeofilter',{_init:function(){var $element=this.$element=$(this.element);if($element.data('wmGeofilterInstance')!=null){return false;}
$element.data('wmGeofilterInstance',this);this.$windowChangeRegion=$('<div class="window-change-region">'+'<a href="#" class="close-window">&times;</a>'+'<h4>Ваш город:</h4>'+'<input type="text" value="" />'+'будут показаны товары с доставкой в этот город</div>');$element.find('.js-city-change').bind('click',this,this.openWindowClickHandler);this.$windowChangeRegion.find('.close-window').bind('click',this,this.closeWindowClickHandler);},openWindowClickHandler:function(e){var instance=e.data,$this=$(this);if($this.closest('.cities').find('.window-change-region').length==0){$this.closest('.cities').append(instance.$windowChangeRegion);instance.$windowChangeRegion.find('input').val($this.find('span').text());$this.closest('.cities').find('.window-change-region').show().animate({opacity:1});}else{$this.closest('.cities').find('.window-change-region').show().animate({opacity:1});}
$this.closest('.cities').find('input').focus().select();if(window.waPostEvent){window.waPostEvent({event:'GeoipWindow',v1:$this.data('city-id')});}
$this.closest('.cities').find('input').autocomplete({appendTo:$('.window-change-region'),autoFocus:true,minLength:0,source:function(request,response){$.ajax({url:'/ajax/city_autocomplete/?q='+encodeURIComponent($this.closest('.cities').find('input').val()),dataType:'json',maxRows:10,success:function(data){if(data.length==0){$this.closest('.cities').find('input').addClass('error');}else{response($.map(data,function(item){return{label:item.city_id,value:item.city}}));$this.closest('.cities').find('input').removeClass('error');}}});},select:function(event,ui){var posScroll='';if($this.closest('.cities').data('position-scroll')!=null){posScroll=$this.closest('.cities').data('position-scroll');}
$('.cities').find('.city').text(ui.item.value);$('.cities').find('.window-change-region').animate({opacity:0},function(){$(this).remove();});location.href='?geodata[city_id]='+ui.item.label+posScroll;}}).data('autocomplete')._renderItem=function(ul,item){var inputVal=$('.window-change-region').find('input').val().toLowerCase();var str=item.value.toLowerCase();var fullStr=str.replace(new RegExp(inputVal,'ig'),'<span class="match">'+inputVal+'</span>');return $("<li></li>").data('item.autocomplete',item).append("<a>"+fullStr+"</a>").appendTo(ul);};e.preventDefault();},closeWindowClickHandler:function(e){var $this=$(this);$this.closest('.window-change-region').animate({opacity:0},function(){$(this).hide();});e.preventDefault();}});$(function(){$('.cities').wmGeofilter();});})(jQuery);

;// googleAnalytics/header.js



$(document).bind('renderpage.finish',function(){if(window._gaq){$('.header #search_query_sample').click(function(e){_gaq.push(['_trackEvent','All','header_view_SearchExample','0',1,true]);});$('.header #search_in_current_category_checkbox').click(function(e){if(this.checked){_gaq.push(['_trackEvent','All','header_select_SearchCurCat','0',1,true]);}});$('.header .cart button[type=submit]').click(function(){_gaq.push(['_trackEvent','All','header_click_ProccessOrder','0',1,true]);});$('.header a.logo').click(function(e){_gaq.push(['_trackEvent','All','header_click_Logo','0',1,true]);});$('.header #login_link').click(function(e){_gaq.push(['_trackEvent','All','header_click_LogIn','0',1,true]);});$('.header #logout_link').click(function(e){_gaq.push(['_trackEvent','All','header_click_LogOut','0',1,true]);});$('.header #registration_link').click(function(e){_gaq.push(['_trackEvent','All','header_click_SignUp','0',1,true]);});$('.header #usernick_link').click(function(e){_gaq.push(['_trackEvent','All','header_click_MyNick','0',1,true]);});$('.header .delivery-link').click(function(){_gaq.push(['_trackEvent','All','header_click_Delivery','0',1,true]);});$('.empty-cart .number-cart a').click(function(){_gaq.push(['_trackEvent','All','header_click_Cart','0',1,true]);});var $menuItems=$('.common-menu .popup-list');$('.common-menu ul.menu-panel').bind('common.menu.open',function(event,n){if(n==0){_gaq.push(['_trackEvent','All','header_view_catAppliances','0',1,true]);}else if(n==1){_gaq.push(['_trackEvent','All','header_view_catElectronics','0',1,true]);}else if(n==2){_gaq.push(['_trackEvent','All','header_view_catComputers','0',1,true]);}else if(n==3){_gaq.push(['_trackEvent','All','header_view_catPhones','0',1,true]);}else if(n==4){_gaq.push(['_trackEvent','All','header_view_catChild','0',1,true]);}else if(n==5){_gaq.push(['_trackEvent','All','header_view_catSport','0',1,true]);}else if(n==6){_gaq.push(['_trackEvent','All','header_view_catDIY','0',1,true]);}else if(n==7){_gaq.push(['_trackEvent','All','header_view_catAuto','0',1,true]);}else if(n==8){_gaq.push(['_trackEvent','All','header_view_catFashion','0',1,true]);}else if(n==9){_gaq.push(['_trackEvent','All','header_view_catBeauty','0',1,true]);}else if(n==10){_gaq.push(['_trackEvent','All','header_view_catPromo','0',1,true]);}else if(n==11){_gaq.push(['_trackEvent','All','header_view_catMore','0',1,true]);}});}});

